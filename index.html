<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCPS IT Department Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0ff1ce;
            --secondary: #1a1a2e;
            --accent: #232946;
            --glass: rgba(255,255,255,0.15);
            --card-bg: rgba(44,62,80,0.85);
            --text: #eaeaea;
            --shadow: 0 8px 32px 0 rgba(31,38,135,0.37);
            --border: 1px solid rgba(255,255,255,0.18);
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Montserrat', Arial, sans-serif;
            background: linear-gradient(120deg, #232946 0%, #0ff1ce 100%);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
        }
        body {
            display: flex;
            min-height: 100vh;
        }
        .sidebar {
            width: 260px;
            background: var(--accent);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 2rem 1rem 1rem 1rem;
            position: fixed;
            height: 100vh;
            z-index: 10;
            border-right: var(--border);
        }
        .sidebar h1 {
            font-family: 'Orbitron', Arial, sans-serif;
            font-size: 2rem;
            color: var(--primary);
            margin-bottom: 2rem;
            letter-spacing: 2px;
            text-shadow: 0 2px 8px #0ff1ce44;
        }
        .nav-links {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 1.2rem;
        }
        .nav-link {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem 1rem;
            border-radius: 12px;
            color: var(--text);
            font-size: 1.1rem;
            font-weight: 700;
            text-decoration: none;
            background: var(--glass);
            border: var(--border);
            transition: background 0.2s, color 0.2s, transform 0.2s;
            cursor: pointer;
        }
        .nav-link.active, .nav-link:hover {
            background: linear-gradient(90deg, var(--primary) 0%, #232946 100%);
            color: #232946;
            transform: translateX(8px) scale(1.05);
            box-shadow: 0 2px 12px #0ff1ce33;
        }
        .main-content {
            margin-left: 280px;
            width: calc(100vw - 280px);
            padding: 3rem 2rem 2rem 2rem;
            display: flex;
            flex-direction: column;
            gap: 2rem;
            background: linear-gradient(120deg, #0ff1ce11 0%, #232946 100%);
            min-height: 100vh;
            transition: background 0.5s;
        }
        .tab-section {
            display: none;
            animation: fadeInTab 0.7s;
        }
        .tab-section.active {
            display: block;
        }
        @keyframes fadeInTab {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .card {
            background: var(--card-bg);
            border-radius: 18px;
            box-shadow: var(--shadow);
            border: var(--border);
            padding: 2rem;
            margin-bottom: 2rem;
            backdrop-filter: blur(8px);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .card:hover {
            /* Remove transform and box-shadow on hover to prevent bounce */
        }
        .card h2, .card h3 {
            font-family: 'Orbitron', Arial, sans-serif;
            color: var(--primary);
            margin-bottom: 1rem;
            letter-spacing: 1px;
        }
        .news-list, .team-list, .download-list, .tutorial-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
        }
        .news-item {
            background: var(--glass);
            border-radius: 14px;
            border: var(--border);
            padding: 1.5rem;
            box-shadow: 0 2px 12px #0ff1ce22;
            transition: background 0.2s;
            color: var(--text);
        }
        .news-item h3 {
            font-family: 'Orbitron', Arial, sans-serif;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            text-decoration: none;
        }
        .news-item h3 a {
            color: var(--primary) !important;
            text-decoration: none !important;
            font-family: 'Orbitron', Arial, sans-serif;
            font-size: 1.2rem;
            font-weight: 500;
            cursor: pointer;
            display: inline-block;
            border-bottom: none !important;
        }
        .news-item h3 a:hover {
            text-decoration: none !important;
            border-bottom: none !important;
        }
        .news-item:hover {
            background: #0ff1ce22;
        }
        .news-item:hover h3 a {
            color: #fff !important;
            text-shadow: 0 2px 8px #0ff1ce99;
        }
        .search-bar {
            width: 100%;
            padding: 0.8rem 1rem;
            border-radius: 8px;
            border: var(--border);
            background: var(--glass);
            color: var(--text);
            margin-bottom: 1.5rem;
            font-size: 1rem;
            outline: none;
            box-shadow: 0 2px 8px #0ff1ce11;
            transition: background 0.2s, color 0.2s;
        }
        .search-bar:focus {
            background: #0ff1ce22;
            color: #232946;
        }
        @media (max-width: 900px) {
            .sidebar { width: 70px; padding: 1rem 0.5rem; }
            .sidebar h1 { font-size: 1.1rem; margin-bottom: 1rem; }
            .nav-link { font-size: 0.9rem; padding: 0.6rem 0.5rem; }
            .main-content { margin-left: 90px; width: calc(100vw - 90px); padding: 2rem 0.5rem; }
        }
        @media (max-width: 600px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; width: 100vw; padding: 1rem 0.2rem; }
        }
        .no-underline {
            text-decoration: none !important;
            border-bottom: none !important;
            color: var(--primary) !important;
            font-family: 'Orbitron', Arial, sans-serif !important;
            font-size: 1.2rem !important;
            font-weight: 500 !important;
        }
        .no-underline:hover {
            text-decoration: none !important;
            border-bottom: none !important;
            color: #fff !important;
            text-shadow: 0 2px 8px #0ff1ce99 !important;
        }
        /* Specific style for Downloads button */
        .news-item h3 a[href="#downloads"] {
            color: var(--primary) !important;
            text-decoration: none !important;
            font-family: 'Orbitron', Arial, sans-serif;
            font-size: 1.2rem;
            font-weight: 500;
            cursor: pointer;
            display: inline-block;
            border-bottom: none !important;
        }
        .team-member {
            background: var(--glass);
            border-radius: 14px;
            border: var(--border);
            padding: 1.5rem;
            box-shadow: 0 2px 12px #0ff1ce22;
            transition: background 0.2s;
            color: var(--text);
        }
        .team-member h3 {
            color: var(--primary);
            font-family: 'Orbitron', Arial, sans-serif;
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
        }
        .team-member p {
            margin: 0.5rem 0;
        }
        .team-member a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.2s;
        }
        .team-member:hover {
            background: #0ff1ce22;
        }
        .team-member:hover a {
            color: #fff;
            text-shadow: 0 2px 8px #0ff1ce99;
        }
        .user-profile {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background: var(--glass);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: var(--border);
            color: var(--text);
            cursor: pointer;
            transition: background 0.2s;
            z-index: 100;
        }
        .user-profile:hover {
            background: #0ff1ce22;
        }
        .user-profile-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: var(--accent);
            border: var(--border);
            border-radius: 8px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            display: none;
            min-width: 120px;
            box-shadow: var(--shadow);
        }
        .user-profile-menu.show {
            display: block;
        }
        .user-profile-menu button {
            background: var(--glass);
            border: var(--border);
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            text-align: left;
            transition: background 0.2s;
            margin-bottom: 0.25rem;
        }
        .user-profile-menu button:last-child {
            margin-bottom: 0;
        }
        .user-profile-menu button:hover {
            background: #0ff1ce22;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal.show {
            display: flex;
        }
        .modal-content {
            background: var(--accent);
            padding: 2rem;
            border-radius: 14px;
            border: var(--border);
            width: 90%;
            max-width: 600px;
            position: relative;
        }
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--text);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
        }
        .modal-close:hover {
            color: var(--primary);
        }
        .modal-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .modal-form input,
        .modal-form textarea {
            background: var(--glass);
            border: var(--border);
            border-radius: 8px;
            padding: 0.8rem;
            color: var(--text);
            font-family: inherit;
        }
        .modal-form textarea {
            min-height: 150px;
            resize: vertical;
        }
        .modal-form button {
            background: var(--primary);
            color: var(--accent);
            border: none;
            border-radius: 8px;
            padding: 0.8rem;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.2s;
        }
        .modal-form button:hover {
            background: #0ff1ce;
        }
        .new-content-indicator {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--primary);
            color: var(--accent);
            padding: 1rem 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: none;
            cursor: pointer;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }
        @keyframes slideIn {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .new-content-indicator:hover {
            background: #0ff1ce;
        }
    </style>
</head>
<body>
    <div id="user-profile" class="user-profile" onclick="toggleUserMenu()">
        <span id="user-name-display">Not signed in</span>
        <div id="user-menu" class="user-profile-menu">
            <button onclick="login()">Sign In</button>
        </div>
    </div>

    <div id="new-content-indicator" class="new-content-indicator" onclick="refreshContent()">
        New content available! Click to refresh.
    </div>

    <!-- New Discussion Modal -->
    <div id="new-discussion-modal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeNewDiscussionModal()">&times;</button>
            <h2 style="color: var(--primary); margin-bottom: 1.5rem;">Create New Discussion</h2>
            <form class="modal-form" onsubmit="submitNewDiscussion(event)">
                <input type="text" id="discussion-title" placeholder="Discussion Title" required>
                <textarea id="discussion-body" placeholder="Discussion Content" required></textarea>
                <button type="submit">Create Discussion</button>
            </form>
        </div>
    </div>

    <aside class="sidebar">
        <h1>KCPS IT</h1>
        <nav class="nav-links">
            <a class="nav-link active" href="#home" onclick="showTab(event, 'home')">üè† Home</a>
            <a class="nav-link" href="#news" onclick="showTab(event, 'news')">üì∞ News</a>
            <a class="nav-link" href="#information" onclick="showTab(event, 'information')">üë• Information</a>
            <a class="nav-link" href="#downloads" onclick="showTab(event, 'downloads')">‚¨áÔ∏è Downloads</a>
            <a class="nav-link" href="#tutorials" onclick="showTab(event, 'tutorials')">üéì Tutorials</a>
            <a class="nav-link" href="#discussions" onclick="showTab(event, 'discussions')">üí¨ Discussions</a>
        </nav>
    </aside>
    <main class="main-content">
        <section id="home" class="tab-section active">
            <div class="card">
                <h2>Welcome to the KCPS IT Department Portal</h2>
                <p>Discover the latest updates, news, and events from the KCPS IT Department. Our portal provides comprehensive information about our team, contact details, and resources to help you manage and set up your devices. Explore our sections for downloads and tutorials to enhance your experience. For assistance or to suggest new features, please contact Jayden Brooks at <a href="mailto:jbrooks2@kcpublicschools.org" style="color:var(--primary);text-decoration:underline;">jbrooks2@kcpublicschools.org</a>.</p>
            </div>
            <div class="news-list">
                <div class="news-item">
                    <h3><a href="#news" onclick="showTab(event, 'news')">Latest News</a></h3>
                    <p>Check out the latest updates and news from the IT Department.</p>
                </div>
                <div class="news-item">
                    <h3><a href="#downloads" onclick="showTab(event, 'downloads')" style="color: var(--primary) !important; text-decoration: none !important; border-bottom: none !important; font-family: 'Orbitron', Arial, sans-serif !important; font-size: 1.2rem !important; font-weight: 500 !important;">Downloads</a></h3>
                    <p>Access our SharePoint site for all available documents.</p>
                </div>
                <div class="news-item">
                    <h3><a href="#tutorials" onclick="showTab(event, 'tutorials')">Tutorials</a></h3>
                    <p>Learn how to manage and maintain your devices with our tutorials.</p>
                </div>
                <div class="news-item">
                    <h3><a href="#information" onclick="showTab(event, 'information')">Information</a></h3>
                    <p>Meet the IT Department team and find contact information.</p>
                </div>
            </div>
        </section>
        <section id="news" class="tab-section">
            <div class="card">
                <h2>Latest News</h2>
                <div class="news-list">
                    <div class="news-item">
                        <h3><a href="https://kcps-it.github.io/KCPS-MacOS-Login-Message" target="_blank">New MacOS Login Window</a></h3>
                        <p>Posted on: March 16, 2024</p>
                        <p>We've introduced a new MacOS login window to enhance security and user experience...</p>
                    </div>
                </div>
            </div>
        </section>
        <section id="information" class="tab-section">
            <div class="card">
                <h2>IT Department Team</h2>
                <div class="filter-container" style="display: flex; gap: 1rem; margin-bottom: 1.5rem;">
                    <input type="search" class="search-bar" placeholder="Search by name or email..." oninput="filterTeamMembers(this.value)">
                    <select class="search-bar" onchange="filterByTeam(this.value)" style="width: auto;">
                        <option value="">All Teams</option>
                        <option value="Leadership">Leadership</option>
                        <option value="Systems">Systems</option>
                        <option value="Network">Network</option>
                        <option value="Building Tech">Building Tech</option>
                        <option value="Service Desk">Service Desk</option>
                        <option value="Ed Tech">Ed Tech</option>
                        <option value="AV">AV</option>
                        <option value="Cyber Security">Cyber Security</option>
                        <option value="Security">Security</option>
                        <option value="Enterprise">Enterprise</option>
                        <option value="Project Management">Project Management</option>
                        <option value="Logistics">Logistics</option>
                        <option value="Purchasing">Purchasing</option>
                    </select>
                </div>
                <div class="team-list" id="teamGrid">
                    <div class="team-member" data-team="Leadership">
                        <h3>Scott Jones</h3>
                        <p>CHIEF TECHNOLOGY OFFICER</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:sjones@kcpublicschools.org">sjones@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Anthony Roberts</h3>
                        <p>ASST DIR OF TECHNOLOGY \ ENTERPRISE OPS</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:aroberts@kcpublicschools.org">aroberts@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Jeff Hearrell</h3>
                        <p>ASST DIR OF TECHNOLOGY \ ENTERPRISE OPS</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:jhearrell@kcpublicschools.org">jhearrell@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Cindy Jackson</h3>
                        <p>TECHNOLOGY SUPPORT MANAGER</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:cjackson@kcpublicschools.org">cjackson@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Ed Tech">
                        <h3>Renae Carter</h3>
                        <p>EDUCATIONAL TECHNOLOGY OPERATIONS MGR</p>
                        <p>Team: Ed Tech</p>
                        <p><a href="mailto:rcarter@kcpublicschools.org">rcarter@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Melinda Shoemaker</h3>
                        <p>ASST DIRECTOR OF EDUCATIONAL TECHNOLOGY</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:mshoemaker@kcpublicschools.org">mshoemaker@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Systems">
                        <h3>Jeff Keltner</h3>
                        <p>SYSTEMS ENGINEER II</p>
                        <p>Team: Systems</p>
                        <p><a href="mailto:jkeltner@kcpublicschools.org">jkeltner@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Network">
                        <h3>Chidi Nwachukwu</h3>
                        <p>NETWORK ENGINEER II</p>
                        <p>Team: Network</p>
                        <p><a href="mailto:cnwachuk@kcpublicschools.org">cnwachuk@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Network">
                        <h3>John Solomon</h3>
                        <p>NETWORK ENGINEER II</p>
                        <p>Team: Network</p>
                        <p><a href="mailto:jsolomon@kcpublicschools.org">jsolomon@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Systems">
                        <h3>Jayden Brooks</h3>
                        <p>SYSTEMS ENGINEER I</p>
                        <p>Team: Systems</p>
                        <p><a href="mailto:jbrooks2@kcpublicschools.org">jbrooks2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Cyber Security">
                        <h3>Travis Willis</h3>
                        <p>INFORMATION SECURITY ANALYST</p>
                        <p>Team: Cyber Security</p>
                        <p><a href="mailto:twillis@kcpublicschools.org">twillis@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Cyber Security">
                        <h3>Nathaniel Jones</h3>
                        <p>SECURITY ENGINEER</p>
                        <p>Team: Cyber Security</p>
                        <p><a href="mailto:njones2@kcpublicschools.org">njones2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Security">
                        <h3>Marlon Andrews</h3>
                        <p>DISTRICT INTEGRATED SECURITY SYS MGR</p>
                        <p>Team: Security</p>
                        <p><a href="mailto:mandrews@kcpublicschools.org">mandrews@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Enterprise">
                        <h3>Christopher Singleton</h3>
                        <p>LEAD SYSTEMS ANALYST DEVELOPER</p>
                        <p>Team: Enterprise</p>
                        <p><a href="mailto:csingleton2@kcpublicschools.org">csingleton2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Connie Aiello</h3>
                        <p>LEAD TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:caiello@kcpublicschools.org">caiello@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Clinton Noland</h3>
                        <p>LEAD TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:cnoland2@kcpublicschools.org">cnoland2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="AV">
                        <h3>Kyle Babb</h3>
                        <p>LEAD AUDIO-VISUAL SPECIALIST</p>
                        <p>Team: AV</p>
                        <p><a href="mailto:kbabb@kcpublicschools.org">kbabb@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="AV">
                        <h3>Victoria Bleyenberg</h3>
                        <p>AUDIO-VISUAL SPECIALIST</p>
                        <p>Team: AV</p>
                        <p><a href="mailto:vbleyenberg@kcpublicschools.org">vbleyenberg@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Ed Tech">
                        <h3>Janice McKinney</h3>
                        <p>MANAGER OF STUDENT INFORMATION SYSTEMS</p>
                        <p>Team: Ed Tech</p>
                        <p><a href="mailto:jmckinney@kcpublicschools.org">jmckinney@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Leadership">
                        <h3>Valencia Griswold</h3>
                        <p>ED TECH LOGISTICS MANAGER</p>
                        <p>Team: Leadership</p>
                        <p><a href="mailto:vgriswold@kcpublicschools.org">vgriswold@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Project Management">
                        <h3>Srenda Green</h3>
                        <p>PROJECT ASSISTANT</p>
                        <p>Team: Project Management</p>
                        <p><a href="mailto:sgreen@kcpublicschools.org">sgreen@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Purchasing">
                        <h3>Tanya Ellis</h3>
                        <p>Educational Technology Ops Spec</p>
                        <p>Team: Purchasing</p>
                        <p><a href="mailto:tellis@kcpublicschools.org">tellis@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Cody Linn</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:colinn@kcpublicschools.org">colinn@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Kevin Jones</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:kjones@kcpublicschools.org">kjones@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Michael Paul Jr.</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST II</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:mpaul@kcpublicschools.org">mpaul@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Yusef Yadullah</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:yyadullah@kcpublicschools.org">yyadullah@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Logistics">
                        <h3>Lake Hall</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Logistics</p>
                        <p><a href="mailto:lhall@kcpublicschools.org">lhall@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Service Desk">
                        <h3>Michael Presko</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Service Desk</p>
                        <p><a href="mailto:mpresko@kcpublicschools.org">mpresko@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Carla Crawford</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:ccrawford@kcpublicschools.org">ccrawford@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Bill Thornton</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:bthornton2@kcpublicschools.org">bthornton2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Iraj Nomani</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:inomani1@kcpublicschools.org">inomani1@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Network">
                        <h3>Doug Mason</h3>
                        <p>ENTERPRISE OPERATIONS ANALYST</p>
                        <p>Team: Network</p>
                        <p><a href="mailto:dmason@kcpublicschools.org">dmason@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Dylan Lock</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:dlock@kcpublicschools.org">dlock@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Joseph Carter</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:jcarter2@kcpublicschools.org">jcarter2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Project Management">
                        <h3>Evely Gonzalez Alvarez</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Project Management</p>
                        <p><a href="mailto:egonzalezalvarez@kcpublicschools.org">egonzalezalvarez@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Logistics">
                        <h3>Anthony Bell NDS</h3>
                        <p>KCPS -Department of Technology</p>
                        <p>Team: Logistics</p>
                        <p><a href="mailto:abell3@kcpublicschools.org">abell3@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Service Desk">
                        <h3>Adam Garcia</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Service Desk</p>
                        <p><a href="mailto:agarcia@kcpublicschools.org">agarcia@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Jirapat Kuengwong</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:jkuengwong@kcpublicschools.org">jkuengwong@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Dereje Tolossa</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:dtolossa@kcpublicschools.org">dtolossa@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Stephen Battle</h3>
                        <p>DAY CUSTODIAN FULL TIME</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:rbattle@kcpublicschools.org">rbattle@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Enterprise">
                        <h3>Wyatt Joseph</h3>
                        <p>ENTERPRISE APPLICATIONS ANALYST</p>
                        <p>Team: Enterprise</p>
                        <p><a href="mailto:wjoseph@kcpublicschools.org">wjoseph@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Victoria Martinez</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:vmartinez@kcpublicschools.org">vmartinez@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Howard Chase</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:hchase1@kcpublicschools.org">hchase1@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Service Desk">
                        <h3>Paul Truss</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Service Desk</p>
                        <p><a href="mailto:ptruss@kcpublicschools.org">ptruss@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Enterprise">
                        <h3>Anthony Draper</h3>
                        <p>ENTERPRISE OPERATIONS ANALYST</p>
                        <p>Team: Enterprise</p>
                        <p><a href="mailto:adraper@kcpublicschools.org">adraper@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Enterprise">
                        <h3>Ricky Blount</h3>
                        <p>ENTERPRISE OPERATIONS ANALYST</p>
                        <p>Team: Enterprise</p>
                        <p><a href="mailto:rblount@kcpublicschools.org">rblount@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Logistics">
                        <h3>Keenan Williams</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Logistics</p>
                        <p><a href="mailto:kwilliams5@kcpublicschools.org">kwilliams5@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Mark Herrada</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:mherrada2@kcpublicschools.org">mherrada2@kcpublicschools.org</a></p>
                    </div>
                    <div class="team-member" data-team="Building Tech">
                        <h3>Julian Mobley</h3>
                        <p>TECHNOLOGY SUPPORT SPECIALIST</p>
                        <p>Team: Building Tech</p>
                        <p><a href="mailto:jmobley@kcpublicschools.org">jmobley@kcpublicschools.org</a></p>
                    </div>
                </div>
            </div>
        </section>
        <section id="downloads" class="tab-section">
            <div class="card">
                <h2>Downloads</h2>
                <div class="download-list">
                    <div class="download-item">
                        <h3>TECHS SharePoint Site</h3>
                        <p>Access our SharePoint site for all available documents.</p>
                        <a href="https://kcpublicschools.sharepoint.com/sites/TECHS/Documents/Forms/AllItems.aspx" style="color:var(--primary);text-decoration:underline;">Go to SharePoint</a>
                    </div>
                </div>
            </div>
        </section>
        <section id="tutorials" class="tab-section">
            <div class="card">
                <h2>Tutorials</h2>
                <input type="search" class="search-bar" placeholder="Search tutorials...">
                <div class="tutorial-list">
                    <div class="tutorial-item">
                        <h3>Apple Tutorials</h3>
                        <p>Learn how to manage and maintain your Apple devices...</p>
                        <a href="https://kcpublicschools.sharepoint.com/sites/TECHS/Documents/Forms/AllItems.aspx?id=%2Fsites%2FTECHS%2FDocuments%2F7%2E%20Training%20Guides%2FApple%20Devices&viewid=d3f241c2%2D1b63%2D458c%2Db5d3%2D6ea2944244f0" style="color:var(--primary);text-decoration:underline;">View Apple Tutorials</a>
                    </div>
                    <div class="tutorial-item">
                        <h3>Windows Tutorials</h3>
                        <p>Learn how to manage and maintain your Windows devices...</p>
                        <a href="https://kcpublicschools.sharepoint.com/sites/TECHS/Documents/Forms/AllItems.aspx?id=%2Fsites%2FTECHS%2FDocuments%2F7%2E%20Training%20Guides%2FWindows&viewid=d3f241c2%2D1b63%2D458c%2Db5d3%2D6ea2944244f0" style="color:var(--primary);text-decoration:underline;">View Windows Tutorials</a>
                    </div>
                </div>
            </div>
        </section>
        <section id="discussions" class="tab-section">
            <div class="card">
                <h2>Discussion Board</h2>
                <div class="discussion-controls" style="margin-bottom: 1.5rem;">
                    <button onclick="createNewDiscussion()" class="search-bar" style="width: auto; cursor: pointer;">Create New Discussion</button>
                </div>
                <div id="user-name-section" style="margin-bottom: 1.5rem; display: none;">
                    <input type="text" id="user-name-input" class="search-bar" placeholder="Enter your name to comment" style="width: 300px;">
                    <button onclick="saveUserName()" class="search-bar" style="width: auto; cursor: pointer; margin-left: 0.5rem;">Save Name</button>
                </div>
                <div id="discussions-list" class="discussion-list">
                    <!-- Discussions will be loaded here -->
                </div>
            </div>
        </section>
    </main>
    <script src="https://alcdn.msauth.net/browser/2.30.0/js/msal-browser.min.js"></script>
    <script>
        // MSAL Configuration
        const msalConfig = {
            auth: {
                clientId: "7aa145f5-62e9-458c-ad3a-12ff059d4f19",
                authority: "https://login.microsoftonline.com/139fe691-d724-4472-abdd-1f3073484955",
                redirectUri: "https://kcps-it.github.io/IT-Department",
                postLogoutRedirectUri: "https://kcps-it.github.io/IT-Department"
            },
            cache: {
                cacheLocation: "sessionStorage",
                storeAuthStateInCookie: false
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);

        // Login request configuration
        const loginRequest = {
            scopes: ["User.Read", "profile", "email"]
        };

        // Handle redirect promise
        msalInstance.handleRedirectPromise().then(handleResponse).catch(err => {
            console.error("Error handling redirect:", err);
        });

        function handleResponse(response) {
            if (response) {
                // User is signed in
                updateUserInterface(response.account);
            } else {
                // Check if user is already signed in
                const currentAccounts = msalInstance.getAllAccounts();
                if (currentAccounts.length > 0) {
                    updateUserInterface(currentAccounts[0]);
                } else {
                    updateUserInterface(null);
                }
            }
        }

        function updateUserInterface(account) {
            const userProfile = document.getElementById('user-profile');
            const userNameDisplay = document.getElementById('user-name-display');
            const userMenu = document.getElementById('user-menu');
            
            if (account) {
                // User is signed in
                currentUser = account;
                userNameDisplay.textContent = `üë§ ${account.name}`;
                userProfile.style.display = 'block';
                
                // Update menu items
                userMenu.innerHTML = `
                    <button onclick="logout()">Sign Out</button>
                `;
            } else {
                // User is not signed in
                currentUser = null;
                userNameDisplay.textContent = 'Not signed in';
                userProfile.style.display = 'block';
                
                // Update menu items
                userMenu.innerHTML = `
                    <button onclick="login()">Sign In</button>
                `;
            }
        }

        async function login() {
            try {
                await msalInstance.loginRedirect(loginRequest);
            } catch (error) {
                console.error("Error during login:", error);
            }
        }

        async function logout() {
            try {
                await msalInstance.logoutRedirect();
            } catch (error) {
                console.error("Error during logout:", error);
            }
        }

        // Update the postComment function to use the authenticated user
        async function postComment(issueNumber) {
            if (!currentUser) {
                alert('Please sign in before posting a comment');
                login();
                return;
            }

            const commentInput = document.getElementById(`comment-input-${issueNumber}`);
            const commentText = commentInput.value.trim();
            
            if (!commentText) {
                alert('Please enter a comment');
                return;
            }
            
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${issueNumber}/comments`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        body: `**${currentUser.name}**: ${commentText}`
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`Failed to post comment: ${response.status} - ${errorData.message}`);
                }
                
                const result = await response.json();
                console.log('Comment posted successfully:', result);
                
                // Clear the input
                commentInput.value = '';
                
                // Reload comments
                loadComments(issueNumber);
                
                // Reload the main discussion list to update comment count
                loadDiscussions();
            } catch (error) {
                console.error('Error posting comment:', error);
                alert(`Error posting comment: ${error.message}`);
            }
        }

        // Update the createNewDiscussion function to use the authenticated user
        function createNewDiscussion() {
            if (!currentUser) {
                alert('Please sign in before creating a discussion');
                login();
                return;
            }
            document.getElementById('new-discussion-modal').classList.add('show');
        }

        // Update the submitNewDiscussion function to use the authenticated user
        async function submitNewDiscussion(event) {
            event.preventDefault();
            
            if (!currentUser) {
                alert('Please sign in before creating a discussion');
                login();
                return;
            }
            
            const title = document.getElementById('discussion-title').value.trim();
            const body = document.getElementById('discussion-body').value.trim();
            
            if (!title || !body) {
                alert('Please fill in all fields');
                return;
            }
            
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        title: title,
                        body: `**Posted by ${currentUser.name}**\n\n${body}`
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`Failed to create discussion: ${response.status} - ${errorData.message}`);
                }
                
                const result = await response.json();
                console.log('Discussion created successfully:', result);
                
                // Close modal and clear form
                closeNewDiscussionModal();
                
                // Reload discussions
                loadDiscussions();
                
                alert('Discussion created successfully!');
            } catch (error) {
                console.error('Error creating discussion:', error);
                alert(`Error creating discussion: ${error.message}`);
            }
        }

        function showTab(event, tabId) {
            event.preventDefault();
            document.querySelectorAll('.tab-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Save the active tab to localStorage
            localStorage.setItem('activeTab', tabId);
        }

        // Add this function to restore the active tab
        function restoreActiveTab() {
            const activeTab = localStorage.getItem('activeTab') || 'home';
            const tabLink = document.querySelector(`.nav-link[href="#${activeTab}"]`);
            if (tabLink) {
                tabLink.click();
            }
        }

        function filterTeamMembers(query) {
            const teamMembers = document.querySelectorAll('.team-member');
            const selectedTeam = document.querySelector('select').value;
            query = query.toLowerCase();
            
            teamMembers.forEach(member => {
                const name = member.querySelector('h3').textContent.toLowerCase();
                const email = member.querySelector('a').textContent.toLowerCase();
                const team = member.getAttribute('data-team');
                
                const matchesSearch = name.includes(query) || email.includes(query);
                const matchesTeam = !selectedTeam || team === selectedTeam;
                
                member.style.display = matchesSearch && matchesTeam ? '' : 'none';
            });
        }

        function filterByTeam(team) {
            const searchQuery = document.querySelector('input[type="search"]').value;
            filterTeamMembers(searchQuery);
        }

        // GitHub Discussions API functions
        const GITHUB_TOKEN = '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';
        const REPO_OWNER = 'KCPS-IT';
        const REPO_NAME = 'IT-Department';

        let currentUser = null;
        let lastDiscussionCount = 0;
        let lastCommentCounts = {};
        let pollingInterval;

        function startPolling() {
            // Check every 30 seconds
            pollingInterval = setInterval(checkForNewContent, 30000);
        }

        function stopPolling() {
            if (pollingInterval) {
                clearInterval(pollingInterval);
            }
        }

        async function checkForNewContent() {
            try {
                // Check for new discussions
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Failed to check for new content: ${response.status}`);
                }
                
                const issues = await response.json();
                
                // Check if there are new discussions
                if (issues.length > lastDiscussionCount) {
                    showNewContentIndicator();
                    lastDiscussionCount = issues.length;
                }
                
                // Check for new comments on each issue
                for (const issue of issues) {
                    const commentsResponse = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${issue.number}/comments`, {
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    });
                    
                    if (commentsResponse.ok) {
                        const comments = await commentsResponse.json();
                        const currentCommentCount = comments.length;
                        
                        if (!lastCommentCounts[issue.number] || currentCommentCount > lastCommentCounts[issue.number]) {
                            showNewContentIndicator();
                            lastCommentCounts[issue.number] = currentCommentCount;
                        }
                    }
                }
            } catch (error) {
                console.error('Error checking for new content:', error);
            }
        }

        function showNewContentIndicator() {
            const indicator = document.getElementById('new-content-indicator');
            indicator.style.display = 'block';
        }

        function refreshContent() {
            const indicator = document.getElementById('new-content-indicator');
            indicator.style.display = 'none';
            loadDiscussions();
        }

        async function loadDiscussions() {
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`GitHub API Error: ${response.status} - ${errorData.message || 'Unknown error'}`);
                }
                
                const issues = await response.json();
                lastDiscussionCount = issues.length;
                displayDiscussions(issues);
            } catch (error) {
                console.error('Error loading discussions:', error);
                document.getElementById('discussions-list').innerHTML = `
                    <div style="background: var(--glass); border-radius: 14px; border: var(--border); padding: 1.5rem; margin-bottom: 2rem;">
                        <h3 style="color: var(--primary); font-family: 'Orbitron', Arial, sans-serif; font-size: 1.2rem; margin-bottom: 0.5rem;">
                            Error Loading Discussions
                        </h3>
                        <p style="color: var(--text);">There was an error loading the discussions. Please try again later.</p>
                        <p style="color: var(--text); font-size: 0.9rem; margin-top: 1rem;">Error details: ${error.message}</p>
                        <button onclick="loadDiscussions()" class="search-bar" style="width: auto; cursor: pointer; margin-top: 1rem;">Retry Loading Discussions</button>
                    </div>
                `;
            }
        }

        function displayDiscussions(issues) {
            const discussionsList = document.getElementById('discussions-list');
            discussionsList.innerHTML = issues.map(issue => `
                <div class="discussion-item" style="background: var(--glass); border-radius: 14px; border: var(--border); padding: 1.5rem; margin-bottom: 2rem; width: 100%; box-sizing: border-box;">
                    <h3 style="color: var(--primary); font-family: 'Orbitron', Arial, sans-serif; font-size: 1.2rem; margin-bottom: 0.5rem;">
                        ${issue.title}
                    </h3>
                    <p style="margin: 0.5rem 0;">${issue.body}</p>
                    <div style="font-size: 0.9rem; color: var(--text); margin-bottom: 1rem;">
                        <span>Posted by ${issue.user.login}</span>
                        <span style="margin-left: 1rem;">${new Date(issue.created_at).toLocaleDateString()}</span>
                        <span style="margin-left: 1rem;">${issue.comments} comments</span>
                    </div>
                    <div class="comments-section" id="comments-${issue.number}" style="margin-top: 1rem; width: 100%;">
                        <button onclick="loadComments(${issue.number})" class="search-bar" style="width: auto; cursor: pointer; margin-bottom: 1rem;">View Comments</button>
                        <div id="comments-list-${issue.number}" style="margin-bottom: 1.5rem; width: 100%;"></div>
                        <div class="comment-form" style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: var(--border); width: 100%; box-sizing: border-box;">
                            <textarea id="comment-input-${issue.number}" class="search-bar" style="width: 100%; min-height: 100px; margin-bottom: 0.5rem; box-sizing: border-box;" placeholder="Write a comment..."></textarea>
                            <button onclick="postComment(${issue.number})" class="search-bar" style="width: auto; cursor: pointer;">Post Comment</button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        async function loadComments(issueNumber) {
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${issueNumber}/comments?per_page=100`, {
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`GitHub API Error: ${response.status} - ${errorData.message || 'Unknown error'}`);
                }
                
                const comments = await response.json();
                const commentsList = document.getElementById(`comments-list-${issueNumber}`);
                
                if (comments.length === 0) {
                    commentsList.innerHTML = '<p style="color: var(--text);">No comments yet. Be the first to comment!</p>';
                    return;
                }
                
                commentsList.innerHTML = comments.map(comment => {
                    // Extract name from comment if it's in our format
                    const nameMatch = comment.body.match(/\*\*(.*?)\*\*:/);
                    const displayName = nameMatch ? nameMatch[1] : comment.user.login;
                    const commentText = nameMatch ? comment.body.replace(/\*\*.*?\*\*:\s*/, '') : comment.body;
                    
                    return `
                        <div class="comment" style="background: var(--card-bg); border-radius: 8px; padding: 1rem; margin-bottom: 1rem; width: 100%; box-sizing: border-box;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                <strong style="color: var(--primary);">${displayName}</strong>
                                <span style="color: var(--text); font-size: 0.9rem;">${new Date(comment.created_at).toLocaleDateString()}</span>
                            </div>
                            <p style="margin: 0;">${commentText}</p>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('Error loading comments:', error);
                document.getElementById(`comments-list-${issueNumber}`).innerHTML = `
                    <div style="background: var(--glass); border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                        <p style="color: var(--primary);">Error loading comments. Please try again.</p>
                        <p style="color: var(--text); font-size: 0.9rem; margin-top: 0.5rem;">Error details: ${error.message}</p>
                        <button onclick="loadComments(${issueNumber})" class="search-bar" style="width: auto; cursor: pointer; margin-top: 0.5rem;">Retry Loading Comments</button>
                    </div>
                `;
            }
        }

        function closeNewDiscussionModal() {
            document.getElementById('new-discussion-modal').classList.remove('show');
            document.getElementById('discussion-title').value = '';
            document.getElementById('discussion-body').value = '';
        }

        // Add this function to handle the user profile click
        function toggleUserMenu(event) {
            event.stopPropagation(); // Prevent the click from bubbling up
            const menu = document.getElementById('user-menu');
            menu.classList.toggle('show');
        }

        // Update the user profile click handler
        document.getElementById('user-profile').addEventListener('click', toggleUserMenu);

        // Close the menu when clicking outside
        document.addEventListener('click', (event) => {
            const userProfile = document.getElementById('user-profile');
            const userMenu = document.getElementById('user-menu');
            if (!userProfile.contains(event.target)) {
                userMenu.classList.remove('show');
            }
        });

        // Start polling when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadDiscussions();
            startPolling();
            // Check if user is already signed in
            const currentAccounts = msalInstance.getAllAccounts();
            if (currentAccounts.length > 0) {
                updateUserInterface(currentAccounts[0]);
            } else {
                updateUserInterface(null);
            }
            // Restore the active tab
            restoreActiveTab();
        });

        // Stop polling when the page is hidden
        document.addEventListener('visibilitychange', () => {
            if (document.hidden) {
                stopPolling();
            } else {
                startPolling();
                checkForNewContent(); // Check immediately when page becomes visible
            }
        });
    </script>
</body>
</html>

